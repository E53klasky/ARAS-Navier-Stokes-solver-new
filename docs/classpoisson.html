<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Saras: poisson Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Saras
   </div>
   <div id="projectbrief">Finite&nbsp;Difference&nbsp;Solver&nbsp;for&nbsp;NSE&nbsp;and&nbsp;MHD&nbsp;Simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="classpoisson-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">poisson Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The base class poisson and its derived classes <a class="el" href="classmultigrid__d2.html" title="The derived class from poisson to perform multi-grid operations on a 2D grid. ">multigrid_d2</a> and <a class="el" href="classmultigrid__d3.html" title="The derived class from poisson to perform multi-grid operations on a 3D grid. ">multigrid_d3</a>.  
 <a href="classpoisson.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="poisson_8h_source.html">lib/poisson.h</a>&quot;</code></p>
<div class="dynheader">
Inheritance diagram for poisson:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classpoisson.png" usemap="#poisson_map" alt=""/>
  <map id="poisson_map" name="poisson_map">
<area href="classmultigrid__d2.html" title="The derived class from poisson to perform multi-grid operations on a 2D grid. " alt="multigrid_d2" shape="rect" coords="0,56,80,80"/>
<area href="classmultigrid__d3.html" title="The derived class from poisson to perform multi-grid operations on a 3D grid. " alt="multigrid_d3" shape="rect" coords="90,56,170,80"/>
</map>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aab9fe3eef6a98c33bf19c2a80c46d814"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aab9fe3eef6a98c33bf19c2a80c46d814">poisson</a> (const <a class="el" href="classgrid.html">grid</a> &amp;mesh, const <a class="el" href="classparser.html">parser</a> &amp;solParam)</td></tr>
<tr class="memdesc:aab9fe3eef6a98c33bf19c2a80c46d814"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor of the base poisson class.  <a href="#aab9fe3eef6a98c33bf19c2a80c46d814">More...</a><br/></td></tr>
<tr class="separator:aab9fe3eef6a98c33bf19c2a80c46d814"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a963e726526e6a6fdcb16c188eda79fb5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a963e726526e6a6fdcb16c188eda79fb5">mgSolve</a> (<a class="el" href="classplainsf.html">plainsf</a> &amp;inFn, const <a class="el" href="classplainsf.html">plainsf</a> &amp;rhs)</td></tr>
<tr class="memdesc:a963e726526e6a6fdcb16c188eda79fb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">The core, publicly accessible function of poisson to compute the solution for the Poisson equation.  <a href="#a963e726526e6a6fdcb16c188eda79fb5">More...</a><br/></td></tr>
<tr class="separator:a963e726526e6a6fdcb16c188eda79fb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b6d857339e8e32b19e984f256439cad"><td class="memItemLeft" align="right" valign="top">virtual real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a9b6d857339e8e32b19e984f256439cad">testTransfer</a> ()</td></tr>
<tr class="memdesc:a9b6d857339e8e32b19e984f256439cad"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to test whether strided data transfer is performing as expected.  <a href="#a9b6d857339e8e32b19e984f256439cad">More...</a><br/></td></tr>
<tr class="separator:a9b6d857339e8e32b19e984f256439cad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5aba6da6b984daa318c096856a89aad5"><td class="memItemLeft" align="right" valign="top">virtual real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a5aba6da6b984daa318c096856a89aad5">testProlong</a> ()</td></tr>
<tr class="memdesc:a5aba6da6b984daa318c096856a89aad5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to test whether prolongation operations are interpolating correctly.  <a href="#a5aba6da6b984daa318c096856a89aad5">More...</a><br/></td></tr>
<tr class="separator:a5aba6da6b984daa318c096856a89aad5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2855b369562564e37b1174950a4ebfae"><td class="memItemLeft" align="right" valign="top">virtual real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a2855b369562564e37b1174950a4ebfae">testPeriodic</a> ()</td></tr>
<tr class="memdesc:a2855b369562564e37b1174950a4ebfae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to test whether periodic BC is being implemented properly.  <a href="#a2855b369562564e37b1174950a4ebfae">More...</a><br/></td></tr>
<tr class="separator:a2855b369562564e37b1174950a4ebfae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a398bf4cdbd25b78f36b6fa610b8cdded"><td class="memItemLeft" align="right" valign="top">virtual real&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a398bf4cdbd25b78f36b6fa610b8cdded">testSolve</a> ()</td></tr>
<tr class="memdesc:a398bf4cdbd25b78f36b6fa610b8cdded"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to test the solver used at the coarsest mesh level of V-Cycle.  <a href="#a398bf4cdbd25b78f36b6fa610b8cdded">More...</a><br/></td></tr>
<tr class="separator:a398bf4cdbd25b78f36b6fa610b8cdded"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a762acf544d50de8666742cf9262f4183"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a762acf544d50de8666742cf9262f4183"></a>
blitz::Array&lt; real, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>pressureData</b></td></tr>
<tr class="separator:a762acf544d50de8666742cf9262f4183"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33300c3b26d4081e83a11b3c7243d9e7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a33300c3b26d4081e83a11b3c7243d9e7"></a>
blitz::Array&lt; real, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>inputRHSData</b></td></tr>
<tr class="separator:a33300c3b26d4081e83a11b3c7243d9e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f7d331974afd6bfab3bab2b3ccdb78e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0f7d331974afd6bfab3bab2b3ccdb78e"></a>
blitz::RectDomain&lt; 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>stagFull</b></td></tr>
<tr class="separator:a0f7d331974afd6bfab3bab2b3ccdb78e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab85b62565db600d1ba62cdb6547e5f2e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab85b62565db600d1ba62cdb6547e5f2e"></a>
blitz::RectDomain&lt; 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>stagCore</b></td></tr>
<tr class="separator:ab85b62565db600d1ba62cdb6547e5f2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad2cecb2bfe5569b7256285ffa385acf4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#ad2cecb2bfe5569b7256285ffa385acf4">solve</a> ()</td></tr>
<tr class="memdesc:ad2cecb2bfe5569b7256285ffa385acf4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to solve the poisson equation at the coarsest multi-grid level.  <a href="#ad2cecb2bfe5569b7256285ffa385acf4">More...</a><br/></td></tr>
<tr class="separator:ad2cecb2bfe5569b7256285ffa385acf4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0ade4f081b9aa098737191193c8f99e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aa0ade4f081b9aa098737191193c8f99e">prolong</a> ()</td></tr>
<tr class="memdesc:aa0ade4f081b9aa098737191193c8f99e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform prolongation on the array being solved.  <a href="#aa0ade4f081b9aa098737191193c8f99e">More...</a><br/></td></tr>
<tr class="separator:aa0ade4f081b9aa098737191193c8f99e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34dcab564048f46bfe636709bd765c39"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a34dcab564048f46bfe636709bd765c39">smooth</a> (const int smoothCount)</td></tr>
<tr class="memdesc:a34dcab564048f46bfe636709bd765c39"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform smoothing operation on the input array.  <a href="#a34dcab564048f46bfe636709bd765c39">More...</a><br/></td></tr>
<tr class="separator:a34dcab564048f46bfe636709bd765c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4b01c19b902b32683b2a6da5c84c569"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aa4b01c19b902b32683b2a6da5c84c569">initMeshRanges</a> ()</td></tr>
<tr class="memdesc:aa4b01c19b902b32683b2a6da5c84c569"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to initialize the Range objects for accessing mesh derivatives in transformed plane.  <a href="#aa4b01c19b902b32683b2a6da5c84c569">More...</a><br/></td></tr>
<tr class="separator:aa4b01c19b902b32683b2a6da5c84c569"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9934adb3c6cb63d1f133ae0aed871d63"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a9934adb3c6cb63d1f133ae0aed871d63">setStagBounds</a> ()</td></tr>
<tr class="memdesc:a9934adb3c6cb63d1f133ae0aed871d63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the RectDomain variables for all future references throughout the poisson solver.  <a href="#a9934adb3c6cb63d1f133ae0aed871d63">More...</a><br/></td></tr>
<tr class="separator:a9934adb3c6cb63d1f133ae0aed871d63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d6c2c4b88ee54fc4be0a31e13708d70"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a2d6c2c4b88ee54fc4be0a31e13708d70">setLocalSizeIndex</a> ()</td></tr>
<tr class="memdesc:a2d6c2c4b88ee54fc4be0a31e13708d70"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to calculate the local size indices of sub-domains after MPI domain decomposition.  <a href="#a2d6c2c4b88ee54fc4be0a31e13708d70">More...</a><br/></td></tr>
<tr class="separator:a2d6c2c4b88ee54fc4be0a31e13708d70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a34d851780fdbd0f97dca6555f80c02"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a6a34d851780fdbd0f97dca6555f80c02">setCoefficients</a> ()</td></tr>
<tr class="memdesc:a6a34d851780fdbd0f97dca6555f80c02"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to set the coefficients used for calculating laplacian and in smoothing.  <a href="#a6a34d851780fdbd0f97dca6555f80c02">More...</a><br/></td></tr>
<tr class="separator:a6a34d851780fdbd0f97dca6555f80c02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a660a034c820a8cf17252732312b3913c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a660a034c820a8cf17252732312b3913c">copyStaggrDerivs</a> ()</td></tr>
<tr class="memdesc:a660a034c820a8cf17252732312b3913c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to copy the staggered grid derivatives from the grid class to local arrays.  <a href="#a660a034c820a8cf17252732312b3913c">More...</a><br/></td></tr>
<tr class="separator:a660a034c820a8cf17252732312b3913c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a490f97075d967bfbe5c692fdea48f719"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a490f97075d967bfbe5c692fdea48f719">imposeBC</a> ()</td></tr>
<tr class="memdesc:a490f97075d967bfbe5c692fdea48f719"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to impose the boundary conditions of Poisson solver at different levels of the V-cycle.  <a href="#a490f97075d967bfbe5c692fdea48f719">More...</a><br/></td></tr>
<tr class="separator:a490f97075d967bfbe5c692fdea48f719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82e9d36121a97499be52c0c617459f6a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a82e9d36121a97499be52c0c617459f6a">updatePads</a> ()</td></tr>
<tr class="memdesc:a82e9d36121a97499be52c0c617459f6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to update the pad points of the local sub-domains at different levels of the V-cycle.  <a href="#a82e9d36121a97499be52c0c617459f6a">More...</a><br/></td></tr>
<tr class="separator:a82e9d36121a97499be52c0c617459f6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa95b6928a8652c3861245399da6143c"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aaa95b6928a8652c3861245399da6143c">createMGSubArrays</a> ()</td></tr>
<tr class="memdesc:aaa95b6928a8652c3861245399da6143c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to create the MPI sub-array data types necessary to transfer data across sub-domains.  <a href="#aaa95b6928a8652c3861245399da6143c">More...</a><br/></td></tr>
<tr class="separator:aaa95b6928a8652c3861245399da6143c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6a4d7b1cd67bc69df92f9bcf3e3901e"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#aa6a4d7b1cd67bc69df92f9bcf3e3901e">vCycle</a> ()</td></tr>
<tr class="memdesc:aa6a4d7b1cd67bc69df92f9bcf3e3901e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to perform one loop of V-cycle.  <a href="#aa6a4d7b1cd67bc69df92f9bcf3e3901e">More...</a><br/></td></tr>
<tr class="separator:aa6a4d7b1cd67bc69df92f9bcf3e3901e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70beec7a8da06e90144e86818d5ef65a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classpoisson.html#a70beec7a8da06e90144e86818d5ef65a">initializeArrays</a> ()</td></tr>
<tr class="memdesc:a70beec7a8da06e90144e86818d5ef65a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to initialize the arrays used in multi-grid.  <a href="#a70beec7a8da06e90144e86818d5ef65a">More...</a><br/></td></tr>
<tr class="separator:a70beec7a8da06e90144e86818d5ef65a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:aee2daa777d57f65ef717183a4c40bead"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aee2daa777d57f65ef717183a4c40bead"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>vLevel</b></td></tr>
<tr class="separator:aee2daa777d57f65ef717183a4c40bead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49a892f57c3b5f7ea99a9723181d1a06"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a49a892f57c3b5f7ea99a9723181d1a06"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>maxCount</b></td></tr>
<tr class="separator:a49a892f57c3b5f7ea99a9723181d1a06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2531f7070365c2371d76759ef2b249"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c2531f7070365c2371d76759ef2b249"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>xStr</b></td></tr>
<tr class="separator:a7c2531f7070365c2371d76759ef2b249"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d343bf1766eba651641b377062f7ae4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4d343bf1766eba651641b377062f7ae4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>yStr</b></td></tr>
<tr class="separator:a4d343bf1766eba651641b377062f7ae4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0dcd7525182f059e4c0846bab25d79"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8d0dcd7525182f059e4c0846bab25d79"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>zStr</b></td></tr>
<tr class="separator:a8d0dcd7525182f059e4c0846bab25d79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dc6f21f196acf05da8d29438bde1cb2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0dc6f21f196acf05da8d29438bde1cb2"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>xEnd</b></td></tr>
<tr class="separator:a0dc6f21f196acf05da8d29438bde1cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa969fe969c2df58d85098acf3c6fb333"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa969fe969c2df58d85098acf3c6fb333"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>yEnd</b></td></tr>
<tr class="separator:aa969fe969c2df58d85098acf3c6fb333"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae6db98267530c84fd2f4898fda3284d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aae6db98267530c84fd2f4898fda3284d"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>zEnd</b></td></tr>
<tr class="separator:aae6db98267530c84fd2f4898fda3284d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab1d97d0883e72d984c1a38a9a0829303"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab1d97d0883e72d984c1a38a9a0829303"></a>
const <a class="el" href="classgrid.html">grid</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>mesh</b></td></tr>
<tr class="separator:ab1d97d0883e72d984c1a38a9a0829303"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87b63589cf01cef8f578a2d5d879a41b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a87b63589cf01cef8f578a2d5d879a41b"></a>
const <a class="el" href="classparser.html">parser</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><b>inputParams</b></td></tr>
<tr class="separator:a87b63589cf01cef8f578a2d5d879a41b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946338c9c8efa1b3c47d16850516e592"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a946338c9c8efa1b3c47d16850516e592"></a>
blitz::Array&lt; real, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>residualData</b></td></tr>
<tr class="separator:a946338c9c8efa1b3c47d16850516e592"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a589f5f5cfb9c148f879c94d5e9a1bce6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a589f5f5cfb9c148f879c94d5e9a1bce6"></a>
blitz::Array&lt; real, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>iteratorTemp</b></td></tr>
<tr class="separator:a589f5f5cfb9c148f879c94d5e9a1bce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7344ed09261f95c8c1850e03d2a562cb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7344ed09261f95c8c1850e03d2a562cb"></a>
blitz::Array&lt; real, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>smoothedPres</b></td></tr>
<tr class="separator:a7344ed09261f95c8c1850e03d2a562cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a953512971631f7945817364aec8efb9a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a953512971631f7945817364aec8efb9a"></a>
blitz::Array&lt; int, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSizeArray</b></td></tr>
<tr class="separator:a953512971631f7945817364aec8efb9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67ae1b3a54edc3f3b600456f2836f101"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a67ae1b3a54edc3f3b600456f2836f101"></a>
blitz::Array&lt; int, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>strideValues</b></td></tr>
<tr class="separator:a67ae1b3a54edc3f3b600456f2836f101"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7c90e99131837dc63489c163772c7e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9c7c90e99131837dc63489c163772c7e"></a>
blitz::TinyVector&lt; int, 3 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>localSizeIndex</b></td></tr>
<tr class="separator:a9c7c90e99131837dc63489c163772c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24743bcf66b813d01c1bafab94932102"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a24743bcf66b813d01c1bafab94932102"></a>
blitz::Array&lt; MPI_Request, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>recvRequest</b></td></tr>
<tr class="separator:a24743bcf66b813d01c1bafab94932102"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f3ad34ac614138d80203d90d2e7b680"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7f3ad34ac614138d80203d90d2e7b680"></a>
blitz::Array&lt; MPI_Status, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>recvStatus</b></td></tr>
<tr class="separator:a7f3ad34ac614138d80203d90d2e7b680"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8104b042af89b49027614909803d1c39"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8104b042af89b49027614909803d1c39"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hx</b></td></tr>
<tr class="separator:a8104b042af89b49027614909803d1c39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52cfc1bfff84b163e7966773d7e1286e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a52cfc1bfff84b163e7966773d7e1286e"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hy</b></td></tr>
<tr class="separator:a52cfc1bfff84b163e7966773d7e1286e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad56e000c82520b5a53171f594a945aa8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ad56e000c82520b5a53171f594a945aa8"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>hz</b></td></tr>
<tr class="separator:ad56e000c82520b5a53171f594a945aa8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e4b2963af68942389b139fa666fcec3"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2e4b2963af68942389b139fa666fcec3"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xixx</b></td></tr>
<tr class="separator:a2e4b2963af68942389b139fa666fcec3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f21457b6f28134bdd7829dc04fca9ff"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0f21457b6f28134bdd7829dc04fca9ff"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xix2</b></td></tr>
<tr class="separator:a0f21457b6f28134bdd7829dc04fca9ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca5fa23498ca5087f76b14ad99c65d2f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aca5fa23498ca5087f76b14ad99c65d2f"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>etyy</b></td></tr>
<tr class="separator:aca5fa23498ca5087f76b14ad99c65d2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a561f5077c96db090de0f3224f0768f65"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a561f5077c96db090de0f3224f0768f65"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ety2</b></td></tr>
<tr class="separator:a561f5077c96db090de0f3224f0768f65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a230b5314d6c66b1b506d7dd6e8b841c4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a230b5314d6c66b1b506d7dd6e8b841c4"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ztzz</b></td></tr>
<tr class="separator:a230b5314d6c66b1b506d7dd6e8b841c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa541f4029f03d1871cb585581a4ddce1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa541f4029f03d1871cb585581a4ddce1"></a>
blitz::Array&lt; real, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>ztz2</b></td></tr>
<tr class="separator:aa541f4029f03d1871cb585581a4ddce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadecb515303818481dbfd1f1d7a95581"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aadecb515303818481dbfd1f1d7a95581"></a>
blitz::Array&lt; blitz::Range, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xMeshRange</b></td></tr>
<tr class="separator:aadecb515303818481dbfd1f1d7a95581"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac98a56d316d3096289fdf3e9e814178e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac98a56d316d3096289fdf3e9e814178e"></a>
blitz::Array&lt; blitz::Range, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>yMeshRange</b></td></tr>
<tr class="separator:ac98a56d316d3096289fdf3e9e814178e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7acdc53b814920813668ca5f2e7b5032"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7acdc53b814920813668ca5f2e7b5032"></a>
blitz::Array&lt; blitz::Range, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>zMeshRange</b></td></tr>
<tr class="separator:a7acdc53b814920813668ca5f2e7b5032"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef047da5a4165559faeaa91f30a1a4df"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aef047da5a4165559faeaa91f30a1a4df"></a>
blitz::Array&lt; MPI_Datatype, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>xMGArray</b></td></tr>
<tr class="separator:aef047da5a4165559faeaa91f30a1a4df"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbc84a897a9f6e66f06eefaad3362270"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adbc84a897a9f6e66f06eefaad3362270"></a>
blitz::Array&lt; MPI_Datatype, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>yMGArray</b></td></tr>
<tr class="separator:adbc84a897a9f6e66f06eefaad3362270"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f2882fa3a67d6e3a961802e65e9622c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5f2882fa3a67d6e3a961802e65e9622c"></a>
blitz::Array<br class="typebreak"/>
&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSendLft</b></td></tr>
<tr class="separator:a5f2882fa3a67d6e3a961802e65e9622c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a894eefe7eec2dd250456615f7073055e"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a894eefe7eec2dd250456615f7073055e"></a>
blitz::Array<br class="typebreak"/>
&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSendRgt</b></td></tr>
<tr class="separator:a894eefe7eec2dd250456615f7073055e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4134c53a43a79b523ac8c5ca0b4cc054"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4134c53a43a79b523ac8c5ca0b4cc054"></a>
blitz::Array<br class="typebreak"/>
&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgRecvLft</b></td></tr>
<tr class="separator:a4134c53a43a79b523ac8c5ca0b4cc054"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2fe9f9948a665cb292c7e71356cee803"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2fe9f9948a665cb292c7e71356cee803"></a>
blitz::Array<br class="typebreak"/>
&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgRecvRgt</b></td></tr>
<tr class="separator:a2fe9f9948a665cb292c7e71356cee803"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ecbed9b004ec7e8414714bed0ca1990"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a4ecbed9b004ec7e8414714bed0ca1990"></a>
blitz::Array<br class="typebreak"/>
&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSendFrn</b></td></tr>
<tr class="separator:a4ecbed9b004ec7e8414714bed0ca1990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3de302e77559db37dae4539fad76d4f8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3de302e77559db37dae4539fad76d4f8"></a>
blitz::Array<br class="typebreak"/>
&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgSendBak</b></td></tr>
<tr class="separator:a3de302e77559db37dae4539fad76d4f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa911270ff4db4eb9487375abe5490219"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa911270ff4db4eb9487375abe5490219"></a>
blitz::Array<br class="typebreak"/>
&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgRecvFrn</b></td></tr>
<tr class="separator:aa911270ff4db4eb9487375abe5490219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a317a4e844d4e0e62b5ef877f082c28d5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a317a4e844d4e0e62b5ef877f082c28d5"></a>
blitz::Array<br class="typebreak"/>
&lt; blitz::TinyVector&lt; int, 3 &gt;, 1 &gt;&#160;</td><td class="memItemRight" valign="bottom"><b>mgRecvBak</b></td></tr>
<tr class="separator:a317a4e844d4e0e62b5ef877f082c28d5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The base class poisson and its derived classes <a class="el" href="classmultigrid__d2.html" title="The derived class from poisson to perform multi-grid operations on a 2D grid. ">multigrid_d2</a> and <a class="el" href="classmultigrid__d3.html" title="The derived class from poisson to perform multi-grid operations on a 3D grid. ">multigrid_d3</a>. </p>
<p>The class implements the geometric multi-grid method for solving the Poisson equation on a non-uniform grid across MPI decomposed domains for parallel computations. The data structure used by the class for computing multi-grid V-cycles across sub-domains is a blitz array with very wide overlap. When calculating the finite differences at the sub-domain boundaries, at the coarsest level of the V-cycle, data points from very deep within the neighbouring sub-domains are necessary. This is the reason for using a wide pad, that spans up to the nearest node of the adjacent sub-domain at the coarsest mesh. This increases the memory footprint, but doesn't increase the computational time as only a single finite-difference calculation is being done using the pads at all levels of the V-cycle.</p>
<p>All the necessary functions to perform the V-cycle - prolongation, solving at coarsest mesh, smoothening, etc. are implemented within the <a class="el" href="classpoisson.html">poisson</a> class. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="aab9fe3eef6a98c33bf19c2a80c46d814"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">poisson::poisson </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classgrid.html">grid</a> &amp;&#160;</td>
          <td class="paramname"><em>mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classparser.html">parser</a> &amp;&#160;</td>
          <td class="paramname"><em>solParam</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor of the base poisson class. </p>
<p>The short base constructor of the poisson class merely assigns the const references to the grid and parser class instances being used in the solver. Moreover, it resizes and populates a local array of multi-grid sizes as used in the grid class. An array of strides to be used at different V-cycle levels is also generated and stored. Finally, the maximum allowable number of iterations for the Jacobi iterative solver being used at the coarsest mesh is set as \( N_{max} = N_x \times N_y \times N_z \), where \(N_x\), \(N_y\) and \(N_z\) are the number of grid points in the collocated grid at the local sub-domains along x, y and z directions respectively.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mesh</td><td>is a const reference to the global data contained in the grid class </td></tr>
    <tr><td class="paramname">solParam</td><td>is a const reference to the user-set parameters contained in the parser class </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a660a034c820a8cf17252732312b3913c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::copyStaggrDerivs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to copy the staggered grid derivatives from the grid class to local arrays. </p>
<p>Though the grid derivatives in the grid class can be read and accessed, they cannot be used directly along with the arrays defined in the poisson class as the local arrays have wide pads on both sides. Therefore, correspondingly wide arrays for grid derivatives are used, into which the staggered grid derivatives from the grid class are written and stored. This function serves this purpose of copying the grid derivatives. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#acb2b1a642f8c37b72c564852eed7f4ca">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#ad42215675be3ef6d96e49855700a3724">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="aaa95b6928a8652c3861245399da6143c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::createMGSubArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to create the MPI sub-array data types necessary to transfer data across sub-domains. </p>
<p>The inter-domain boundaries of all the sub-domains at different V-cycle levels need data to be transfered at with different mesh strides. The number of sub-arrays along each edge/face of the sub-domains are equal to the number of V-cycle levels. Since this data transfer has to take place at all the mesh levels including the finest mesh, there will be vcDepth + 1 elements. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#a159045a7fe683f8942c11d110f714fd9">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a2cedcb665f0cb49f1986d954da7a913c">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a490f97075d967bfbe5c692fdea48f719"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::imposeBC </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to impose the boundary conditions of Poisson solver at different levels of the V-cycle. </p>
<p>This function is called mainly during smoothing operations to impose the boundary conditions for the Poisson equation. The sub-domains close to the wall will have the Neumann boundary condition on pressure imposeed at the walls. Meanwhile at the interior boundaries at the inter-processor sub-domains, data is transferred from the neighbouring cells by calling the <a class="el" href="classpoisson.html#a82e9d36121a97499be52c0c617459f6a">updatePads</a> function. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#ae768dfd460a349aa6d2f8f7b7a63ad09">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a9891f62d47bfc8f0217eed0aed5eb7b7">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a70beec7a8da06e90144e86818d5ef65a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::initializeArrays </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to initialize the arrays used in multi-grid. </p>
<p>The memory required for various arrays in multi-grid solver are pre-allocated through this function. The function is called from within the constructor to perform this allocation once and for all. The arrays are initialized to 0. </p>

</div>
</div>
<a class="anchor" id="aa4b01c19b902b32683b2a6da5c84c569"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::initMeshRanges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to initialize the Range objects for accessing mesh derivatives in transformed plane. </p>
<p>The Range objects defined here are used for reading the values of grid metrics at all the V-cycle levels. Since these values are required at all the grid levels, there are vcDepth + 1 number of Range objects. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#a80a1db6b10788f1cf1fb9b2ed441e1e3">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a6075b6b3f875f7df3e948a3667868c5f">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a963e726526e6a6fdcb16c188eda79fb5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::mgSolve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classplainsf.html">plainsf</a> &amp;&#160;</td>
          <td class="paramname"><em>inFn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classplainsf.html">plainsf</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The core, publicly accessible function of poisson to compute the solution for the Poisson equation. </p>
<p>The function calls the V-cycle as many times as set by the user. Before doing so, the input data is transferred into the data-structures used by the poisson class to perform restrictions and prolongations without copying. Finally, the computed solution is transferred back from the internal data-structures back into the scalar field supplied by the calling function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inFn</td><td>is a pointer to the plain scalar field (cell-centered) into which the computed soltuion must be transferred </td></tr>
    <tr><td class="paramname">rhs</td><td>is a const reference to the plain scalar field (cell-centered) which contains the RHS for the Poisson equation to solve </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#a3a047b87ad6c7cf0bb4648ba4fe9df98">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a16a31bd3b2d3ad54b919e625db1695b4">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="aa0ade4f081b9aa098737191193c8f99e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::prolong </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to perform prolongation on the array being solved. </p>
<p>Prolongation makes the grid finer by averaging values at two adjacent nodes onto an intermediate point between them As a result, the number of points in the domain increases from \( 2^N + 1 \) at the input level to \( 2^{N+1} + 1 \). The vLevel variable is accordingly reduced by 1 to reflect this ascent by one step up the V-Cycle. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#a917b053d920d142a9be32418ba0b7d6f">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#af434c5fddf5bf5a3c82660d0e20e631d">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a6a34d851780fdbd0f97dca6555f80c02"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::setCoefficients </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to set the coefficients used for calculating laplacian and in smoothing. </p>
<p>The function assigns values to the variables hx, hy etc. These coefficients are repeatedly used at many places in the Poisson solver. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#ad8e6ed137f140179e0835a144a496b31">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a54974463cb8de698e734ee3438f86f15">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a2d6c2c4b88ee54fc4be0a31e13708d70"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::setLocalSizeIndex </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to calculate the local size indices of sub-domains after MPI domain decomposition. </p>
<p>For the multi-grid solver, the number of grid nodes must be \( 2^N + 1 \) to perform V-Cycles The domain decomposition is also done in such a way that each sub-domain will also have \( 2^M + 1 \) points. As a result, the number of processors in each direction must be a power of 2. In this case, the the value \( M \) of \( 2^M + 1 \) can be computed as \( M = N - log_2(np) \) where \( np \) is the number of processors along the direction under consideration. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#ab1ddb3d52831b44902b4987acca88d78">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#ad471ed617e5e78b9d8888df006dfe85d">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a9934adb3c6cb63d1f133ae0aed871d63"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::setStagBounds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to set the RectDomain variables for all future references throughout the poisson solver. </p>
<p>The function sets the core and full domain staggered grid sizes for all the sub-domains. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#ac89c1a857bcca222129d0d92e80a3076">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a0986dab3bd0dc77f2ccd1d3856025ba1">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a34dcab564048f46bfe636709bd765c39"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::smooth </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>smoothCount</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to perform smoothing operation on the input array. </p>
<p>The smoothing operation is always performed on the data contained in the array pressureData. The array iteratorTemp is used to store the temporary data and it is continuously swapped with the pressureData array at every iteration. This operation can be performed at any level of the V-cycle.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">smoothCount</td><td>is the integer value of the number of smoothing iterations to be performed </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#aca4530dc4898b1d0ab6468b1753c266b">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a58432fb9f7db5525aa2080209bde5f31">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="ad2cecb2bfe5569b7256285ffa385acf4"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::solve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to solve the poisson equation at the coarsest multi-grid level. </p>
<p>This function operates exclusively at the lowest level of the multi-grid V-cycle. It uses the Jacobi iterative solver to solve the residual of the Poisson equation on the coarsest mesh. Note that the all calculations are performed assuming that the vLevel variable is maximal when the function is being called. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#ac9783032e3623eceb6ee3ac7ac824388">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a3427721b7dfb195a8f61f0f3a8b01e91">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a2855b369562564e37b1174950a4ebfae"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real poisson::testPeriodic </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to test whether periodic BC is being implemented properly. </p>
<p>The function populates the arrays with predetermined values at all locations. It then calls imposeBC function at different vLevels and checks if the correct values of the functions are imposed at boundaries This done by printing the contents of the arrays for visual inspection for now. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#afc3eb5df1502f7c55f8d716dbec070cc">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a36d39d10145268fd551280d870b6b7a1">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a5aba6da6b984daa318c096856a89aad5"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real poisson::testProlong </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to test whether prolongation operations are interpolating correctly. </p>
<p>The function populates the arrays with predetermined values at all locations. It then calls prolong function at a lower vLevel and checks if the data is being interpolated correctly at higher vLevel This done by returning the average deviation from correct values as a real value </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#a84b56f2d55c0c26ea2f2beee363e3520">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#af50893d991beceb3762cc22c6b48d980">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a398bf4cdbd25b78f36b6fa610b8cdded"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real poisson::testSolve </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to test the solver used at the coarsest mesh level of V-Cycle. </p>
<p>The function populates the arrays with predetermined values at all locations. It then calls solve function at lowest vLevel and compares the exact analytical values This done by printing the contents of the arrays for visual inspection for now. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#a78bf6bbd1f5873be456f502d73d24982">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#ad3badf0bdd11550b048984a1ac06457b">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a9b6d857339e8e32b19e984f256439cad"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">real poisson::testTransfer </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to test whether strided data transfer is performing as expected. </p>
<p>The function populates the arrays with predetermined values at all locations. It then calls updatePads at different vLevels and checks is the data is being transferred along x and y directions This done by printing the contents of the arrays for visual inspection for now. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#af0622319df641d434ca81b589ea7a489">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a039726d6912b47042565d4a2b3d33ab9">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="a82e9d36121a97499be52c0c617459f6a"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::updatePads </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to update the pad points of the local sub-domains at different levels of the V-cycle. </p>
<p>This function is called mainly during smoothing operations by the <a class="el" href="classpoisson.html#a490f97075d967bfbe5c692fdea48f719">imposeBC</a> function. It is also specifically called by the <a class="el" href="classpoisson.html#ad2cecb2bfe5569b7256285ffa385acf4">solve</a> function while solving the equation at the coarsest mesh level. At the interior boundaries at the inter-processor sub-domains, data is transferred from the neighbouring cells using a combination of MPI_Irecv and MPI_Send functions. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#ac80f4c62ce5700c2188683ae052c05df">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#af12e992210696bdc1e5961e5855a5e18">multigrid_d2</a>.</p>

</div>
</div>
<a class="anchor" id="aa6a4d7b1cd67bc69df92f9bcf3e3901e"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void poisson::vCycle </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Function to perform one loop of V-cycle. </p>
<p>The V-cycle of restrictions, prolongations and smoothings are performed within this function. First the input data contained in pressureData is smoothed, after which the residual is computed and stored in the residualData array. The restrictions, smoothing, and prolongations are performed on these two arrays subsequently. </p>

<p>Reimplemented in <a class="el" href="classmultigrid__d3.html#a966e9bebcecf223a04048768a5dbe742">multigrid_d3</a>, and <a class="el" href="classmultigrid__d2.html#a552c8e589fe38424afb163acde49b0dd">multigrid_d2</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>lib/poisson/<a class="el" href="poisson_8h_source.html">poisson.h</a></li>
<li>lib/poisson/<a class="el" href="poisson_8cc.html">poisson.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 6 2020 16:21:50 for Saras by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
