<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Saras: paper</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Saras
   </div>
   <div id="projectbrief">Finite&nbsp;Difference&nbsp;Solver&nbsp;for&nbsp;NSE&nbsp;and&nbsp;MHD&nbsp;Simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">paper </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
<p> title: 'SARAS: A general-purpose PDE solver for fluid dynamics'</p>
<p>tags:</p>
<ul>
<li>C++</li>
<li>PDE</li>
<li>turbulence</li>
<li>fluid dynamics</li>
</ul>
<p>authors:</p>
<ul>
<li>name: Roshan Samuel orcid: 0000-0002-1280-9881 affiliation: 1</li>
<li>name: Shashwat Bhattacharya orcid: 0000-0001-7462-7680 affiliation: 1</li>
<li>name: Ali Asad orcid: 0000-0001-9704-6686 affiliation: 2</li>
<li>name: Soumyadeep Chatterjee orcid: 0000-0001-7957-1727 affiliation: 2</li>
<li>name: Mahendra K. Verma orcid: 0000-0002-3380-4561 affiliation: 2</li>
</ul>
<p>affiliations:</p>
<ul>
<li>name: Department of Mechanical Engineering, Indian Institute of Technology - Kanpur index: 1</li>
<li>name: Department of Physics, Indian Institute of Technology - Kanpur index: 2</li>
</ul>
<p>date: 15 January 2020</p>
<p>bibliography: resources/paper.bib </p>
<hr/>
<h1>Summary</h1>
<p>The laws that govern natural systems can often be modelled mathematically using partial differential equations (PDEs). Usually the resultant PDEs are not solvable analytically, hence numerical solutions become important in such cases. As a result, efficient numerical solutions of PDEs are important for understanding such systems. In this paper we briefly describe the design and validation of a finite difference solver <code>SARAS</code>.</p>
<p><code>SARAS</code> is a general-purpose PDE solver based on finite difference method [:book:CFD; :book:CFD], written in an object-oriented structure in C++. In <code>SARAS</code>, the underlying mathematical constructs like vector and scalar fields are defined as classes. Moreover, vector calculus operations associated with such fields, like gradient and divergence, are defined using these classes. This design makes the code intuitive, allowing users to quickly cast PDEs into readable codes. The initial conditions, boundary conditions, and source/forcing terms are implemented using <code>initial</code>, <code>boundary</code> and <code>force</code> classes. These classes are readily extensible so that users can add custom initial conditions, source terms, and so on.</p>
<p><code>SARAS</code> includes solvers for hydrodynamic flows, namely the incompressible Navier-Stokes initial value problem (IVP), as well as for scalar convection, like Rayleigh Benard Convection. Presently, we use semi-implicit Crank-Nicholson [:1947] method for time-advancing the IVP. The solver uses Marker and Cell method (MAC) [:PF1965] for discretizing the velocity and pressure fields.</p>
<h1>Mathematics</h1>
<p>The Navier-Stokes equations, which govern the dynamics of fluid flow, can be written as $$ { {u}}{ t} + {u}{u} = - p + {f} + ^2{u}, $$ where ${u}$ is the velocity field, $p$ is the pressure field, ${f}$ is the forcing term, and $$ is the kinematic viscosity of the fluid. The fluid is assumed to be incompressible. Hence ${u} = 0$, and density is constant (chosen to be unity).</p>
<p>If the velocity and pressure field at time $t = t_n$ are denoted as ${u}_n$ and $p_n$ respectively, then the corresponding fields at the next time-step, $t = t_{n+1}$, namely ${u}_{n+1}$ and $p_{n+1}$, can be calculated as described below [:1972IJHMT; :book:CFD; :book:CFD]. We compute an intermediate velocity field using the known values, ${u}_n$ and $p_n$, as $$ {u}^* = {u}_{n} +  t[^2 ( {{u}_n + {u}^*}{2}) - {u}_n.{u}_n -  p_n]. $$ The forcing term has been neglected here for simplicity. Note that the diffusion term (also called the viscous term) is handled semi-implicitly, with equal contribution from ${u}_n$ and ${u}^*$, as given below: $$ {u}^* -  t[{^2{u}^*}{2}  ] = {u}_{n} +  t[{^2{u}_n}{2} - {u}_n.{u}_n -  p_n]. $$ The above equation has to be solved iteratively, and this is achieved through OpenMP-parallelized Jacobi iterations. The intermediate velocity field, ${u}^*$, does not satisfy the continuity equation, and requires appropriate correction. This correction is obtained from the pressure correction term, which is calculated using the pressure Poisson equation, $$ ^2 p^* = {.{u}^*}{ t}. $$ <code>SARAS</code> uses a Geometric Multigrid library to solve the above equation [:MG2004; :MG2000]. Presently the library employs the Full Multigrid (FMG) V-Cycle to solve the Poisson equation. Other methods like F-Cycle and W-Cycle are planned updates to the library in future.</p>
<p>Finally, using the above pressure correction, the velocity and pressure fields corresponding to the next time-step are obtained as $$ p_{n+1} = p_n + p^*, $$ $$ {u}_{n+1} = {u}^* -  t( p^*). $$ The numerical implementation of the above procedure will be discussed in the next section.</p>
<h1>Numerical Method and Implementation</h1>
<p><code>SARAS</code> uses finite-difference method [:book:CFD] to calculate derivatives of the field variables. Presently the solver uses second-order central difference stencils to compute first and second derivatives. We use a highly optimized and fast array manipulation library, Blitz++ [:CP1998], for all array operations. Blitz++ also offers finite-difference stencils on uniformly spaced grids. <code>SARAS</code> augments this feature with grid-transformation terms [:book:CFD] to perform simulations on grids with non-uniform spacing.</p>
<p><code>SARAS</code> offers a set of extensible boundary and initial conditions, as well as source terms. Presently the solver can switch between periodic, Neumann, and Dirichlet boundary conditions. There also exists a mixed boundary condition class that can simulate many practical applications, such as a conducting heating plate on an adiabatic wall [:2017]. Currently the solver is restricted to Cartesian grids, but it will be extended to cylindrical, toroidal, and spherical grids in the future. The solver also supports adaptive time-stepping, where the Courant-Friedrichs-Lewy (CFL) condition [:1928CFL] is used to dynamically compute the appropriate time-step.</p>
<h1>Results</h1>
<p>We validate our code using two very well-known test problems: lid-driven cavity and decaying turbulence. We simulate these problems using <code>SARAS</code> and compare the results with standard and validated solutions.</p>
<h2>Problem 1</h2>
<p>We solve the two-dimensional lid-driven cavity (LDC) problem using <code>SARAS</code>, and compare the results with those of :JCP1982. LDC is an important fluid system and it serves as a benchmark for testing numerical methods. This system consists of a square cavity of dimension $1  1$ with no-slip boundary conditions on all the four walls. However, the top wall moves laterally to the right with a constant velocity of $U = 1.0$ that serves as the reference velocity for non-dimensionalization of the problem. The length of the side of the cavity, $L = 1.0$, is the reference length. The Reynolds number of the flow is approximately ${Re}  1000$.</p>
<p>At the start of the simulation, the fluid, which is at rest, is driven impulsively by the top lid. This results in the formation of a vortex at the upper-right corner of the cavity, and this vortex rapidly grows in size and occupies the entire region of the cavity. For the simulation we employ a $129  129$ grid, and carry it out till $t = 30$. The solver computes this solution using 4 MPI processes in approximately 12 minutes on an Intel workstation. The output by <code>SARAS</code> at the final time is used for comparison with the results of :JCP1982</p>
<p>In the website we supply the Bash and Python scripts to compile and run this test case. After automatic execution of <code>SARAS</code>, a Python script reads the output from <code>SARAS</code> and compares the horizontal and vertical velocity profiles across the geometric center of the square cavity. The corresponding results from :JCP1982 are also available with the installation. We compare the two results and exhibit them in Figure figure1}. We observe that the profiles computed by <code>SARAS</code> match very well with those by :JCP1982, thus providing a strong validation for our code. This quick validation of the solver, which can be done as a part of its installation, is one of the strengths of this package.</p>
<p>![Velocity profiles from the simulation of lid-driven cavity on a $129^2$ grid with <code>SARAS</code> (orange lines), plotted along with the data from :JCP1982 (blue stars): (a) The vertical profile of the x-component of velocity, $u_x$, along the line across the geometric center of the cavity (b) The horizontal profile of the z-component of velocity, $u_z$, along the line across the geometric center of the cavity. {figure1}](resources/ldc_profiles.png)</p>
<h2>Problem 2</h2>
<p>We simulate decaying turbulence using <code>SARAS</code> with Taylor-Green vortex [:RSPA1937] as the initial condition. That is, $$ {u}(x,y,z, t=0) = u_{0} {bmatrix} (2  k_{0} x) (2  k_{0}y) (2  k_{0}z) \ -(2  k_{0} x) (2  k_{0}y) (2  k_{0}z) \ 0 {bmatrix}, $$ where $u_0 = 1$ and $k_0 = 1$. We perform our simulation in a periodic box of size $1  1  1$ ($L=1$) with a grid resolution of $257^{3}$ up to $t = 3.0$. Here, we nondimensionalize time using $L/u_0$. The initial Reynolds number of the flow is ${Re} = 1000$. We choose a constant $dt = 0.001$ for time-integration. Besides, we use a uniform mesh along all the three directions.</p>
<p>To validate the accuracy of the finite difference scheme of <code>SARAS</code>, we compare the results of <code>SARAS</code> with those of a pseudo-spectral code <code>TARANG</code>, which has been benchmarked and scaled up to 196608 cores of Cray XC40, Shaheen II of KAUST [:JPDC2018; :Pramana2013tarang]. Note that pseudo-spectral method yields very accurate derivatives [:book:SpectralFluid]. We perform our spectral simulation using the same initial condition and grid resolution as above, up to $t = 3.0$. The comparison of the results from the two codes is discussed below. Comparison of <code>SARAS</code> results with those of <code>TARANG</code> provides another validation of <code>SARAS</code>.</p>
<p>The results of <code>TARANG</code> and <code>SARAS</code> are quite similar, as exhibited in Figures figure2} and figure3}. In Figure figure2}(a) we exhibit the plots of the total energy ($ d{ r} u^2/2$) vs. time for both the runs. As is evident from the plots, both the codes yield very similar evolution profiles for the total energy. In addition, we also compute the energy spectra for the results at $t=1$. As shown in Figure figure2}(b), both the energy spectra are very similar. Interestingly, in both the plots, the energy spectra in the inertial range are close to the $k^{-5/3}$ power law [:DANS1941Dissipation; :book:ET].</p>
<p>![For the simulation of decaying turbulence on a $257^3$ grid with <code>TARANG</code> (thick blue lines) and <code>SARAS</code> (red-dashed lines): (a) plot of the total energy $E_u=  d{ r} u^2/2$ vs $t$, (b) plot of $E_u(k)$ vs $k$ at $t =1$. {figure2}](resources/tgv_spectrum.png)</p>
<p>Figure figure3} exhibits the magnitude of velocity, $|{u}|$, on the horizontal mid-plane ($z=1/2$) at $t=1$ and $t=3$. Clearly, the results of <code>TARANG</code> and <code>SARAS</code> are very similar.</p>
<p>![For the simulation of decaying turbulence on a $257^3$ grid, vector plots of the velocity field, and the density plots of the magnitude of velocity ($|{u}|$) computed at the horizontal mid-plane: for the data from <code>TARANG</code>(a, c), and <code>SARAS</code>(b, d) at $t = 1$ (top row) and $t = 3$ (bottom row). {figure3}](resources/tgv_velocity.png)</p>
<h1>Conclusions</h1>
<p>This paper provides a brief description and validations tests of a new parallel finite-difference code <code>SARAS</code>. <code>SARAS</code> has been designed as a general PDE solver using the object-oriented features of C++. We validate <code>SARAS</code> using two test cases: lid-driven cavity and decaying turbulence.</p>
<h1>Acknowledgements</h1>
<p>We gratefully acknowledge the contributions from Gaurav Gautham, Saurav Bhattacharjee, Rishabh Sahu, and Fahad Anwer during the development of SARAS. </p>
<hr/>
<h1>References</h1>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Thu Feb 6 2020 17:28:28 for Saras by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
