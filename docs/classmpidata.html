<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Saras: mpidata Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Saras
   </div>
   <div id="projectbrief">Finite&nbsp;Difference&nbsp;Solver&nbsp;for&nbsp;Fluid&nbsp;Dynamics&nbsp;Simulations</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&#160;List</span></a></li>
      <li><a href="classes.html"><span>Class&#160;Index</span></a></li>
      <li><a href="hierarchy.html"><span>Class&#160;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&#160;Members</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classmpidata-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">mpidata Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Class to store MPI derived datatypes for individual arrays.  
 <a href="classmpidata.html#details">More...</a></p>

<p><code>#include &quot;<a class="el" href="mpidata_8h_source.html">lib/mpidata.h</a>&quot;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:ade73109930c9fc61d4ad200e409d03f3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmpidata.html#ade73109930c9fc61d4ad200e409d03f3">mpidata</a> (blitz::Array&lt; real, 3 &gt; inputArray, const <a class="el" href="classparallel.html">parallel</a> &amp;parallelData)</td></tr>
<tr class="memdesc:ade73109930c9fc61d4ad200e409d03f3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor of the mpidata class.  <a href="#ade73109930c9fc61d4ad200e409d03f3">More...</a><br/></td></tr>
<tr class="separator:ade73109930c9fc61d4ad200e409d03f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5e92feda8a0a86595b3d2264af2618ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmpidata.html#a5e92feda8a0a86595b3d2264af2618ef">createSubarrays</a> (const blitz::TinyVector&lt; int, 3 &gt; globSize, const blitz::TinyVector&lt; int, 3 &gt; coreSize, const blitz::TinyVector&lt; int, 3 &gt; padWidth, const bool xStag, const bool yStag)</td></tr>
<tr class="memdesc:a5e92feda8a0a86595b3d2264af2618ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to create the subarray MPI_Datatypes.  <a href="#a5e92feda8a0a86595b3d2264af2618ef">More...</a><br/></td></tr>
<tr class="separator:a5e92feda8a0a86595b3d2264af2618ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c722bece264a65a06c1843ab0ae9ae3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmpidata.html#a8c722bece264a65a06c1843ab0ae9ae3">syncData</a> ()</td></tr>
<tr class="memdesc:a8c722bece264a65a06c1843ab0ae9ae3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function to send data across all sub-domain faces.  <a href="#a8c722bece264a65a06c1843ab0ae9ae3">More...</a><br/></td></tr>
<tr class="separator:a8c722bece264a65a06c1843ab0ae9ae3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a2aba921899554381996cc564ff21bbd0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2aba921899554381996cc564ff21bbd0"></a>
const <a class="el" href="classparallel.html">parallel</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classmpidata.html#a2aba921899554381996cc564ff21bbd0">rankData</a></td></tr>
<tr class="memdesc:a2aba921899554381996cc564ff21bbd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">A const reference to the global variables stored in the parallel class to access rank data. <br/></td></tr>
<tr class="separator:a2aba921899554381996cc564ff21bbd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Class to store MPI derived datatypes for individual arrays. </p>
<p>Since the solver uses staggered and collocated grids, the data of its variables are stored in arrays of different limits depending on whether the variable is staggered or not in each direction. As a result, the limits of the sub-arrays to be sent across inter-processor boundaries is different for different arrays. Hence the <b>mpidata</b> class contains MPI_SUBARRAY derived datatypes to be initialized along with different fields in order to store their sub-arrays for inter-processor communication. </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="ade73109930c9fc61d4ad200e409d03f3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">mpidata::mpidata </td>
          <td>(</td>
          <td class="paramtype">blitz::Array&lt; real, 3 &gt;&#160;</td>
          <td class="paramname"><em>inputArray</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classparallel.html">parallel</a> &amp;&#160;</td>
          <td class="paramname"><em>parallelData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor of the mpidata class. </p>
<p>The short constructor of mpidata class merely resizes the array of MPI_Status and MPI_Request datatypes. The former is used in non-blocking communication of MPI_Irecv, while the later is used in the MPI_Waitall function to complete the non-blocking communication call.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">inputArray</td><td>is the blitz array whose sub-arrays have to be created and synchronised across processors </td></tr>
    <tr><td class="paramname">parallelData</td><td>is a const reference to the global data contained in the parallel class </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a class="anchor" id="a5e92feda8a0a86595b3d2264af2618ef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mpidata::createSubarrays </td>
          <td>(</td>
          <td class="paramtype">const blitz::TinyVector&lt; int, 3 &gt;&#160;</td>
          <td class="paramname"><em>globSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const blitz::TinyVector&lt; int, 3 &gt;&#160;</td>
          <td class="paramname"><em>coreSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const blitz::TinyVector&lt; int, 3 &gt;&#160;</td>
          <td class="paramname"><em>padWidth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>xStag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>yStag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to create the subarray MPI_Datatypes. </p>
<p>Must be called only after the grid class has been initialized. The subarray data-types cannot be created within the constructor of the parallel class as it needs the grid parameters for setting the limits of the subarrays. For this, the grid class will have to be included in the parallel class.</p>
<p>However, the grid object cannot be passed to the parallel class as the grid class already includes the parallel object within itself, and a reverse include will raise cyclic dependency error. As a result, the mpidata class offers an additional layer over the parallel class for grid specific data transfer functions.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">globSize</td><td>stores the global size of a sub-domain - including core and pads </td></tr>
    <tr><td class="paramname">coreSize</td><td>stores the size of the core of the sub-domain and is similar to the collocCoreSize variable in the grid class </td></tr>
    <tr><td class="paramname">padWidth</td><td>contains the widths of pads along the 3 directions, namely padWidths TinyVector from the grid class </td></tr>
    <tr><td class="paramname">xStag</td><td>specifies whether the array to which the instance of <a class="el" href="classmpidata.html">mpidata</a> class is associated with has its data points staggered in x-direction or not </td></tr>
    <tr><td class="paramname">yStag</td><td>specifies whether the array to which the instance of <a class="el" href="classmpidata.html">mpidata</a> class is associated with has its data points staggered in y-direction or not </td></tr>
  </table>
  </dd>
</dl>
<p>The <b>loclSize</b> variable holds the local size of the sub-array slice to be sent/received within the sub-domain.</p>
<p>The <b>saStarts</b> variable holds the starting coordinates of the sub-array slice.</p>
<p>The <b>globCopy</b> variable holds a copy of the global size of the sub-domain. This keeps the original array safe </p>

</div>
</div>
<a class="anchor" id="a8c722bece264a65a06c1843ab0ae9ae3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void mpidata::syncData </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to send data across all sub-domain faces. </p>
<p>This is the core function of the mpidata class. The end slices of each sub-domain recieves data from their corresponding neighbouring sub-domains, while the interior slices of each sub-domain sends data to their corresponding neighbouring sub-domains.</p>
<p>All the data slices are send as subarray MPI derived data-types created in the <a class="el" href="classmpidata.html#a5e92feda8a0a86595b3d2264af2618ef">createSubarrays</a> function. As a result, <a class="el" href="classmpidata.html#a8c722bece264a65a06c1843ab0ae9ae3">syncData</a> must be called only after the subarrays have been created.</p>
<p>The data transfer is implemented here with a mixture of blocking and non-blocking communication calls. The recieves are non-blocking, while the sends are blocking. This combination prevents inter-processor deadlock. </p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>lib/parallel/<a class="el" href="mpidata_8h_source.html">mpidata.h</a></li>
<li>lib/parallel/<a class="el" href="mpidata_8cc.html">mpidata.cc</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sat Feb 8 2020 16:51:54 for Saras by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
